# 【2023年版】Microsoft Power Apps 基礎マスターコース

## セクション２：まずはPower　Appsのアプリを使ってみよう
エクセルをパワーアップスで使用する際に事前にローカルに用意されたのを使用します。

そのファイルをどこかのクラウドストレージにアップロードします。例えば、OneDrive。

クラウドストレージに上げる際にそのエクセルファイルをテーブルとしてアップロードします。(Insert as a table)

今度はテーブルデザインにておそらく”テーブル１”書かれているところにちゃんと”顧客管理表”と名前を変更してください。いわゆる、ファイルと同じ名前に変更することです。

事前準備のほうはできましたのでPower　Appsに戻って左側のオプションにて”作成”をクリックしますそこからファイルのアクセスに進みます。Excelのメニューを押します。

自分のPower　Appsがちゃんとファイルがアップロードされたクラウドストレージと接続してるのかを確認してください。（僕の場合はOneDrive　Businessに接続が必要でした）

そのあとにファイルにクリックしてテーブル接続を進めます。そして自動的にスタンダードなアプリが自動設計されます。

いわゆるExcelのファイルはSQLの役目を務めている。

# セクション３：自動生成アプリを編集しよう

## このセクションで学習すること:
Power Appsを攻略する近道は以下のポイントです：
・コントロール
・プロパティ
・数式（関数）

自動生成されるアプリの特徴である：
・Browser Screen（一覧表示画面）
・Detail Screen（評細画面）
・Edit Screen（編集画面）
理解をする。

## アプリの保存方法：
・”Play”ボタンの隣に”Save”ボタンがあります。それを押すだけ。
・名前を付けての保存と表示されます、基本はファイルと同じ名前にセーブします。
・最後に”保存”ボタンを押してちゃんと保存されます。

注意：セーブボタンの横に”公開”ボタンがありますけど、それは押さないように気をつけてください。押してしまうと社内全般に自分の出来損ないのアプリが公表されます。

## Power Apps数式の打ち方：
今度はPower Appsの数式にいじります。与信調査に関して与信評価が記載せれるか否かに対して”未”か＂済”に自動的にとりわけをします。これを通じてPower　Appsの構造を理解することにつなげます。

##　Power　Appsの構造：
単純に説明しますとPower　Appsの構造はそのアプリが作成された際にその上に命令を作ることが可能です。プログラミング上では何かのメゾットをボタンがクリックされた時点で作るこステップのに対してPower Appsはそれをせずとも直接がソフトを通じて作成できます。詳細設定が可能です。いわゆるCSSとメゾットの作成がプログラミング知識なしでも作成と数式設定が可能です。

ツリービューでにそのアプリケーションが作成された構造が表示されています。

Power　Appsアプリの構造のまとめ。ザックリと以下の特徴が上げられます：
・コントロール　ー＞部品（画面・ボタン・テキストボックス）ー　HTML　TO　BUIDING　BTN
・プロパティ　ー＞コントロールの属性（ボタンの色・大きさ・選択する）ー　CSS
・数式（関数）ー＞コントロールのプロパティに対する値や動作を決める。ー　メゾット（Methods）

##　新しいアイコンの加え方：
では、先ほどおっしゃった詳細設定に取り組む前になれるために何ができるのかを見せます：
・BrowseScreen1に行きますと顧客管理のリストが表示されます。
・BrowserGallery１ー＞Separatorへとステップを進みます、クリックしてください。
・そのあとに右上の画面に”挿入”ボタンにクリックします。
・今回は”アラーム”と言われるアイコンを挿入します、クリックしてください。
・そうしますと画面のBrowserScreen1にそのアイコンがすべての顧客管理リストに表示されます。
・現れたアイコンにクリックしてマウスを動かしますと同時に合わられたほかのアイコンも画一的に動かせます。
・今回はそのアイコンは使用しませんので削除してください。やり方は”Icon2”と現れた画面に”・・・”にクリックしてオプションの中から”削除”が表示されます。

##　フィールドの変更・情報表示のやり方：
では、Galleryに表示するフィールドを変更します：Matrix（LineｘColumnn）＜＝＞数列（行・レコードｘ列・フィールド）（Japanese　People　Is Crazy！！）（But　In Power Apps the line is called as Item）
・BrowserScreen1の表示されている顧客管理リストになんの客なのかがわかるようにそれを現すフィールドを取り組みます。
・BrowserGallery1にクリックしますと右側の画面にBrowserGallery1のプロパティと詳細設定が表示されます。
・プロパティに表示られたレイアウトにクリックしますとどのように顧客管理リストの表示のやり方ができるのかをオプション式で見せられます。
・要求されている内容に対応のあるオプションを選びます。
・今回はタイトル、サブタイトル、本文のレイアウトでよろしいです。
・その上に表示されたいフィールドを表示します。
・レイアウトの上に”フィールド”のオプションがございますのでそこにクリックします。
・データといわれる表示がされます。
・今回はその上に付け加えたいフィールドをつけて行きます。
・Title3:顧客名、Subtitle2:与信調査、Body2：営業担当者　と入れてください。
・これらの情報はまだ乏しいので今度はもっとフィールドをつけ食えるためにBrowserGallery1ー＞Body1をクリックします。
・今度はそれに営業担当者のテキストを記載するためにプロパティを使用します。
・そこに”ｆｘ”と数式にこのように打ってください、（”営業担当者：”　＆　ThisItem.営業担当）。
・そうしますと、ほかの顧客管理リストに画一的にその数式の影響が与えられます。
・では、同じように他のSubtitle2とTitle３も数式をいじりましょう。それぞれのフィールドの名前をBody１と同じ世に記載するだけです。

##　コントローラのつけ方そしてその上の数式の加え方：
今度は、顧客管理リストに表示されているアイテムに”EditScreen”に直接いけるコントローラを作成します：
・BrowserGallery1ー＞Separatorにクリック。
・挿入ボタンにクリック。
・先ほどアラームアイコンを作成するためやりました同じステップです。
・今回は”編集”のオプションを探します。
・そのアイコンをDetailScreenへと移動するためのボタンの左横へとセッティングします。
・そして、そのアイコンをセレクトしたままそこにEditScreenへと誘導するための数式を入れます。
・プロパティリストを”OnSelect”にしてそれに数式を入れます。
・ Navigate（EditScreen1, ScreenTransition.None）と打ってください。
・そうすればそのアイコンにクリックしますと自動的にEditScreenの画面へと変更されます。
・実際にそれを見るためにアプリを”Play”します。

##　関数の基本とNavigate関数について解説します：
・URLのリンクを通して読んでください：https://power-magic.jp/function-archive/navigate/

##　フォームの概要とギャラリーの違いについて解説します：
・URLリンクを通して読んでください：https://powerplatformnikki.com/viewform/

##　Display　Formのコントロールの階層について解説：
・URLのリンクを通して読んでください：https://dx.si-jirei.jp/cloud-column-microsoft_powerplatform-5/

##　Display　Formに表示されているデータソースのフィールドを変更する方法：
・DetailScreen1ー＞DetailForm1に行きますとなぜだか与信評価といううデータカードが無いですね。
・それでは、それを追加します。
・DetailForm1をセレクトしたまま右側に現れるプロパティのフィールドにクリックします。
・フィールドの画面が表示された際には”フィールドの追加”に押します。
・オプションとしてフィールドの選択が現れましてそこに”与信評価”の選択をして”追加”ボタンを押します。
・そうしますと”与信評価”のフィールドが現れました。
・顧客管理表の一番下に表示されます。
・今度は同じ”フィールド”の画面を通して表示されているフィールドの順番を並び変えましょう。

##　Display Formのフィールドを修正する際の注意点：
登録日の修正をいたします。９時００分を取り除いて年・月・日のみを取り入れられるように修正します。
・まずは登録日のデータカードを選択します。
・今度は、右側に移っている詳細設定に”プロパティを変更するためのロックを解除します”にクリックして変更を可能とデータカードの変更を可能とします。

##　Display form上にあるコントロールのTextプロパティを修正する【Text関数の使い方】：
URLのリンクを通して：　https://ippu-biz.com/development/powerplatform/powerapps/text-date/
・DetailForm1ー＞登録日＿DataCard1ー＞DataCardValueへと行きます。
・プロパティに”Text”とセレクトします。
・それにまつわる数式に”Text(BrowserGallery1.Selected.登録日,DateTimeFormat.ShortDate)"と記載してください。
・そうすると、顧客管理表の登録日がちゃんと年・月・日と省略されます。

##　テキストラベルの表示を修正する【Selectedプロパティの応用】：
DetailScreen1のフォーム以外のコントロールを修正しようと思います。
・今回はDetailScreen1の顧客表テキストラベルの修正を行います。
・まずはDetailScreen1へと向かってそのラベルをセレクトします。
・次にLblAppName1をセレクトします。
・プロパティは”Text”です。
・そのプロパティの数式にこのように入れます”BrowseGallery1.Selected.顧客名”。

## EditScreenの概要とEdit formの役割について:
今回はEditScreenの編集と修正を行います。URL：https://learn.microsoft.com/en-us/power-apps/maker/model-driven-apps/create-and-edit-forms
・EditScreenをセレクトします。
・チェックマークの付いたコントローラをセレクトします。
・自動的にプロパティに見せられるのは”OnSelect”です。
・SubmitForm関数が記載された情報をデータソースへとセーブする役割を果たしています。 URL:https://learn.microsoft.com/en-us/power-platform/power-fx/reference/function-form

## Edit formにドロップダウンコントロールを配置する:
・まずはEditScreenのフィールドの並び替えを行います。
・EditFormをセレクトします。
・フィールドの配置の変え方は以前に行った副賞となります。
・ドロップダウンコントロールを配置します。
・EditFormの中にあるフィールドの与信調査＿DataCardの中にありますDataCardValueをセレクトします。
・挿入から入力のオプションにてドロップダウンを選択します。
・ロック解除と追加ボタンを押します。
・そのドロップダウンの中にテキストを埋め込みます。
・プロパティに”Items”をセレクトします。
・数式にこのように入れます”["未","済"]”。

## SubmitForm関数とUpdateプロパティについて:
先ほど配置したドロップダウンコントローラにSumitFormの数式を入れていきます。
・まずはEditFormの中にあるフィールドの与信調査＿DataCardの中にありますDataCardValueをセレクトします。
・プロパティに”Update”をセレクトします。
・その数式には元々あったDataCardValueが記載されています。
・その数式を変更します、Dropdown1.Selected.Value。
・元々あったテクスト入力のカードを削除します。
・エラー、罰点、マークが表示されます。
・罰点マークにクリックして数式の調整を施します。
・以前存在していたDataCardValueをDropdown1へと変更して、問題が解決されます。

## Edit formの2つの役割と3つのフォームモードについて:
EditFormでは編集と新規の導入があることを解説してきます。
・EditModeは編集モードと新規モードがあると認識してください。
・EditoForm1をセレクトします。
・プロパティに”DefaultMode”を選択します。
・数式にFromMode.Editっと書かれています。
・数式に”FromMode.New”と変えてみましょう。
・そうしますと記載されていた情報が消えて新しい情報が記載可能な状態になります。
・今度は”FromMode.View”へと数式をかえてください。
・そうしますと、今度は記載された情報たちがテキストレベルへと変換しました。読み取り専用のモードになります。

## If関数の基本的な使い方:
自分はもう知っている。

    If(条件式、値が真（しん）の場合、値が偽（にせ）の場合)

## Last関数を使ってEdit formが新規モードの際に顧客コードを自動採番する方法:
顧客コードの値を編集していきます。
・EditoForm１へと行きそして顧客コードをセレクトします。
・プロパティに”Update”を選択します。
・現在はDataCardValue11と数式枠に記載されています。
・まずは右側から詳細設定でプロパティの変更を許可をするようにロックを解除します。
・数式枠でこのようなIF関数を入れてください、If（EditForm１．Mode＝FromMode.New、Last（顧客管理表）.顧客コード＋１、DataCardValue１１．Text）。

## フォームモードによってコントロールのVisibleプロパティを変更する方法:
新規モードの時にもう一つ修正を施す必要のあるテクストがございますのでその修正をします。
・EditoForm１へと行きそして顧客コードをセレクトします。
・プロパティリストから”Visible”を選択してください。
・数式にはBooleanになっております。
・そこにIf関数を入れます、If（EditForm1.Mode＝FormMode.New,false,true）。
・そしたら試します”Play”ぼたんを押します。
・新規モードにしますと、以前存在した顧客コードが見えなくなっています。

## Edit formのディスプレイモードに応じてコントロールのディスプレイモードを条件分岐させる方法:
顧客コードが編集モードになっている場合に修正を施すことをします。
・EditoForm１ー＞顧客コードー＞DataCardValue3をセレクトします。
・プロパティに”DisplayMode”を選択します。
・その数式にIf関数を入れます、If（EditForm1.Mode＝FormMode.Edit,DisplayMode.View）。
・実際試してみます。”Play”ボタンを押して編集モードになりましたら、顧客コードが読み取りのみになっております。

## DataCard内にあるStarVisibleコントロールについて解説:
URL:https://powerusers.microsoft.com/t5/Building-Power-Apps/Card-for-a-required-field-does-not-display-the-The-StarVisible/td-p/125107

・EditForm１－＞顧客名＿Data＿DataCard2。
・右側に詳細設定にデータのRequireをFalseからTrueへを変更します。
・そうしますと新規モードのときに顧客名の記入が必須となります。

## 登録日の時間と分のコントロールを非表示にする:
直接削除をしますとエラーが発生します。その上、修正にも時間がかかります。なので時間と分の表示は非表示にします。
・EditFormにて時間と分の枠をセレクトしまして両方のプロパティの”Visible”をTrueからFalseへと変更します。
・今度は登録日のアップデータプロパティを変更する必要があります。
・その数式にこう入れます、Text（DateValue1.SelectedDate、DateTimeFormat。ShortDate）。

## キャンバスアプリの公開方法:
アプリの修正が完了しましたのでそのアプロの公開をしていきます。
・右上に公開といううボタンがありますのでそれを押していただきます。

## アプリを実際に起動して動作確認を行う:

## 日付フィールドに時間が入ってしまう不具合の回避方法:
・まずは顧客管理表の登録日の左側にもう一つフィールドを作ります。
・そのフィールドの名前を登録日と更新してください。
・そのあとEditFormにてそのフィールドを追加します。
・それでプロパティに”Update”を選択します。
・そしたら数式でこれを入れましょう、Text（DatePincker1.SelectedDate，”ｙｙｙｙ／ｍｍ／ｄｄ”）。
・Previewをするときには顧客管理表のテーブルは閉じたままにしてください。

# セクション４：ピザ注文アプリで変数を理解する

## このセクションで学習すること:
・変数の基本。
・PowerAppsで変数を利用する方法。
・Set関数の使い方。
・変数をクリアする方法。
・関数の使い方。

## ピザ注文アプリの完成版デモンストレーション:
だたのプレゼンテーション。

## 空のアプリからキャンバスアプリを作成する:
・まずはPowerAppsにアクセスしまして作成にて”空のアプリ”にクリックします。
・”空のキャンパスアプリ”を選択します。
・アプリ名に”ピザ注文アプリ”と記入してください。
・形式には”電話”を選択します。スマホ用のアプリを製作しますので。
・”作成”ボタンをクリックします。
・今回は自動生成されるよりかはまっさらな画面が表示されます。
・Screen1にて、まず初めに、一つだけのコントローラを配置します。
・挿入ボタンからテキストラベルを選択します。

## コントロールをコピペして複数追加する方法:
テキストラベルとボタンをとことん取り入れていきます。
・挿入するコントローラたちはコピペが可能です。

## コントロールのテキストプロパティとコントロール名をリネームする:
ラベルとボタンのリネーム方法について説明していきます。

・まずはテキストをセレクトします。
・右側にありますプロパティにてテキスト枠にテキストを変えて行きます。
・ボタンも同じようにします。
・今度はScreenに表示されていラベルとボタンたちの名前を変更していきます。
・例えばとしますとLabel1にあります”・・・”に押して”名前の変更を選択します。

## 変数とは:(variavel)

## 変数には特定の型が存在する:(escreve depois uma funcao cujo o dominio e carteziano de cada tipo de dados primitivos, int, string, boolean, etc...)

## Power Appsで変数を利用するために必要なSet関数について:(OneSelect e mais usado para usar a funcao Set)

## Set関数を使って注文ボタンにメニュー名と金額を代入する:
注文ボタンに変数を埋め込んでいきましょう。
・まずはマルゲリータの注文ボタンを選択します。
・そしてプロパティでは”OneSelect”を選択します。
・数式の中にSet関数を入れます、”Set(ピザ名,lblMargherita.Text);Set(ピザ金額,lblPriceMargherita.Text)"。
・同じように注文ボタンを持つメニューたちにも関数のセッティングを施します。

## テキストラベルに宣言した変数を表示させる:
・ピザ名のテキストプロパティを選択してください。
・そこに数式を今あるテキストとともにSet関数を統合します。
・＆を使ってSet関数を組み込んでいきます、”ピザ名：”　&　ピザ名。
・今度は同じくピザ名の円を選択してそこにピザ金額と入れましょう、ピザ金額　&　”円”。
・同じくドリンク名とその円にも数式を統合して行きます。
・最後に合計金額の円ではピザ名とドリンク名のそれぞれ円が足された数式を統合します、ピザ金額　＋　ドリンク金額　＆　”円”。
・では実際に統合された数式たちがちゃんと機能しているかを探るためにそのアプリを作動します。

## Blank関数を使って注文を取り消す処理を入力する:
注文取消のボタンに変数を埋め込んでいきます。
・注文取消ボタンを選択します。
・OneSelectプロパティにを選択します。
・数式にSet関数を導入します、Set(ピザ名,Blank());Set(ピザ金額,Blank());Set(ドリンク名,Blank());Set(ドリンク金額,Blank())。
・実際に機能しているかどうかを確認するためにアプリをプレビューしてみましょう。

## Onstartプロパティを使ってアプリ立ち上げ時に変数が初期化する処理を追加する:
アプリを使用している最中に画面を閉じたら、今の状態だと中途半端に以前選んだオプションがあります。それは、見た目的にはすごくダメなので、もしもそのようなことが起きましたら再度アプリを開いた際には全部がブランク状態、いわゆるアプリを初期状態、になるようにOnstartを使用します。
・ツリービューのAppと表示されているところにクリックしてください。
・プロパティにOnstartと選択をします。備考：Onstartはアプリの起動時のことを表しております。
・その数式にこのように挿入します、Set(ピザ名,Blank());Set(ピザ金額,Blank());Set(ドリンク名,Blank());Set(ドリンク金額,Blank())。
・実際機能しているかを確認しましょう、プレビューボタンを押します。

## アプリに新しく画面を追加する:
注文確定ボタンを押した際に違う画面へと変更するように、その新しい画面を追加します。
・ツリービューのほうに”＋新しい画面”とボタンがあります。そこに、クリックしてください。
・レイアウトとオプションに“空”と現れるのでクリックします。
・Screen2がツリービューに現れます。

## 新規画面のボタンにアプリを閉じるExit関数を埋め込む:
新規画面にテキストラベルとアプリを閉じるボタンを挿入します。
・テキストラベルとボタンの挿入は以前行った復習になります。
・ボタンにOnSelectプロパティを選択します。
・アプリを閉じる関数を埋め込んで行きます、Exit()。
・実際にそのExit（）関数か格納されたかを確認するためにプレビューしましょう。

## Navigate関数を使って注文確定ボタンに画面遷移させる処理を埋め込む:
今度は、新しく作られた画面のほうに移るために注文確定ボタンに変数を埋め込んでいきます。
・注文確定ボタンのコントロールを選択します。
・OnSelectプロパティに法に数式を次の数式を埋め込みます、Navigate(Screen2,ScreenTransition.Fade)。
・実際機能しているかを確認しましょう、プレビューボタンを押します。

## ピザ注文アプリの見た目の体裁を整える:
レイアウト・見た目を整えていきます。
・テキストとボタンのサイズ・体裁を変更していきます。

## ピザ注文アプリを実際に起動して動作確認を行う:
プレビューをして動作確認をしましょう。

# セクション５：トラブル管理表アプリの作成

## このセクションで学習すること：
・SharePointのリスクとデータを接続する方法。
・If関数で条件によってコントロールの表示を変更する。
・検索機能を実装。
・コントロールをグループ化する方法。
・変数の実践的な利用法。
・Collect関数を利用したデータソースへのデータ反映方法。

## アプリのデモンストレーションと業務シナリオ：


## チームサイトにエクセルデータをインポートしてリストを作成する

## リストの日付列の設定変更とリスト名の変更

## チームサイトのリストからアプリを自動生成する

## BrowseScreenのギャラリーのフィールドを編集＆変更する

## ギャラリーのフィールド色をフィールドの値によって変更する方法

## ドロップダウンボックスのItemsプロパティに検索条件を設定する

## Power Appsから参照する際に必要なSharePointリストの内部列名について

## Search関数を使ってキーワード検索をする方法

## Filter関数でステータス条件の絞り込みを行う

## If関数を使って検索条件に応じて処理を分岐させる

## 実装した検索機能をプレビューで確認する

## Reset関数を使って検索窓に入れたキーワードをクリアする

## DetailScreenの体裁を整える

## EditScreenの体裁を整える

## コントロールをグループ化してVisibleプロパティに変数を入力する

## EditScreenのOnVisibleプロパティに変数を宣言する

## Edit formのOnSuccessプロパティを使って変数の値を変更する

## グループ化したボタンコントロールにNavigate関数を埋め込む

## 新規登録用画面を作成して入力用コントロールを配置する

## Collect関数をボタンに埋め込んで新規データをリストへ送信する

## NewScreenのOnVisibleプロパティにReset関数を埋め込んでテキスト入力をクリアする

## アプリ起動時に表示されるStartScreenを作成する

## アプリをプレビューして動作確認を行う
