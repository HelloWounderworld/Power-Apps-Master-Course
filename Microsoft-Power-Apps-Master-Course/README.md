# 【2023年版】Microsoft Power Apps 基礎マスターコース

## セクション２：
エクセルをパワーアップスで使用する際に事前にローカルに用意されたのを使用します。

そのファイルをどこかのクラウドストレージにアップロードします。例えば、OneDrive。

クラウドストレージに上げる際にそのエクセルファイルをテーブルとしてアップロードします。(Insert as a table)

今度はテーブルデザインにておそらく”テーブル１”書かれているところにちゃんと”顧客管理表”と名前を変更してください。いわゆる、ファイルと同じ名前に変更することです。

事前準備のほうはできましたのでPower　Appsに戻って左側のオプションにて”作成”をクリックしますそこからファイルのアクセスに進みます。Excelのメニューを押します。

自分のPower　Appsがちゃんとファイルがアップロードされたクラウドストレージと接続してるのかを確認してください。（僕の場合はOneDrive　Businessに接続が必要でした）

そのあとにファイルにクリックしてテーブル接続を進めます。そして自動的にスタンダードなアプリが自動設計されます。

いわゆるExcelのファイルはSQLの役目を務めている。

# セクション３：

## このセクションで学習すること:
Power Appsを攻略する近道は以下のポイントです：
・コントロール
・プロパティ
・数式（関数）

自動生成されるアプリの特徴である：
・Browser Screen（一覧表示画面）
・Detail Screen（評細画面）
・Edit Screen（編集画面）
理解をする。

## アプリの保存方法：
・”Play”ボタンの隣に”Save”ボタンがあります。それを押すだけ。
・名前を付けての保存と表示されます、基本はファイルと同じ名前にセーブします。
・最後に”保存”ボタンを押してちゃんと保存されます。

注意：セーブボタンの横に”公開”ボタンがありますけど、それは押さないように気をつけてください。押してしまうと社内全般に自分の出来損ないのアプリが公表されます。

## Power Apps数式の打ち方：
今度はPower Appsの数式にいじります。与信調査に関して与信評価が記載せれるか否かに対して”未”か＂済”に自動的にとりわけをします。これを通じてPower　Appsの構造を理解することにつなげます。

##　Power　Appsの構造：
単純に説明しますとPower　Appsの構造はそのアプリが作成された際にその上に命令を作ることが可能です。プログラミング上では何かのメゾットをボタンがクリックされた時点で作るこステップのに対してPower Appsはそれをせずとも直接がソフトを通じて作成できます。詳細設定が可能です。いわゆるCSSとメゾットの作成がプログラミング知識なしでも作成と数式設定が可能です。

ツリービューでにそのアプリケーションが作成された構造が表示されています。

Power　Appsアプリの構造のまとめ。ザックリと以下の特徴が上げられます：
・コントロール　ー＞部品（画面・ボタン・テキストボックス）ー　HTML　TO　BUIDING　BTN
・プロパティ　ー＞コントロールの属性（ボタンの色・大きさ・選択する）ー　CSS
・数式（関数）ー＞コントロールのプロパティに対する値や動作を決める。ー　メゾット（Methods）

##　新しいアイコンの加え方：
では、先ほどおっしゃった詳細設定に取り組む前になれるために何ができるのかを見せます：
・BrowseScreen1に行きますと顧客管理のリストが表示されます。
・BrowserGallery１ー＞Separatorへとステップを進みます、クリックしてください。
・そのあとに右上の画面に”挿入”ボタンにクリックします。
・今回は”アラーム”と言われるアイコンを挿入します、クリックしてください。
・そうしますと画面のBrowserScreen1にそのアイコンがすべての顧客管理リストに表示されます。
・現れたアイコンにクリックしてマウスを動かしますと同時に合わられたほかのアイコンも画一的に動かせます。
・今回はそのアイコンは使用しませんので削除してください。やり方は”Icon2”と現れた画面に”・・・”にクリックしてオプションの中から”削除”が表示されます。

##　フィールドの変更・情報表示のやり方：
では、Galleryに表示するフィールドを変更します：Matrix（LineｘColumnn）＜＝＞数列（行・レコードｘ列・フィールド）（Japanese　People　Is Crazy！！）（But　In Power Apps the line is called as Item）
・BrowserScreen1の表示されている顧客管理リストになんの客なのかがわかるようにそれを現すフィールドを取り組みます。
・BrowserGallery1にクリックしますと右側の画面にBrowserGallery1のプロパティと詳細設定が表示されます。
・プロパティに表示られたレイアウトにクリックしますとどのように顧客管理リストの表示のやり方ができるのかをオプション式で見せられます。
・要求されている内容に対応のあるオプションを選びます。
・今回はタイトル、サブタイトル、本文のレイアウトでよろしいです。
・その上に表示されたいフィールドを表示します。
・レイアウトの上に”フィールド”のオプションがございますのでそこにクリックします。
・データといわれる表示がされます。
・今回はその上に付け加えたいフィールドをつけて行きます。
・Title3:顧客名、Subtitle2:与信調査、Body2：営業担当者　と入れてください。
・これらの情報はまだ乏しいので今度はもっとフィールドをつけ食えるためにBrowserGallery1ー＞Body1をクリックします。
・今度はそれに営業担当者のテキストを記載するためにプロパティを使用します。
・そこに”ｆｘ”と数式にこのように打ってください、（”営業担当者：”　＆　ThisItem.営業担当）。
・そうしますと、ほかの顧客管理リストに画一的にその数式の影響が与えられます。
・では、同じように他のSubtitle2とTitle３も数式をいじりましょう。それぞれのフィールドの名前をBody１と同じ世に記載するだけです。

##　コントローラのつけ方そしてその上の数式の加え方：
今度は、顧客管理リストに表示されているアイテムに”EditScreen”に直接いけるコントローラを作成します：
・BrowserGallery1ー＞Separatorにクリック。
・挿入ボタンにクリック。
・先ほどアラームアイコンを作成するためやりました同じステップです。
・今回は”編集”のオプションを探します。
・そのアイコンをDetailScreenへと移動するためのボタンの左横へとセッティングします。
・そして、そのアイコンをセレクトしたままそこにEditScreenへと誘導するための数式を入れます。
・プロパティリストを”OnSelect”にしてそれに数式を入れます。
・ Navigate（EditScreen1, ScreenTransition.None）と打ってください。
・そうすればそのアイコンにクリックしますと自動的にEditScreenの画面へと変更されます。
・実際にそれを見るためにアプリを”Play”します。

##　関数の基本とNavigate関数について解説します：
・URLのリンクを通して読んでください：https://power-magic.jp/function-archive/navigate/

##　フォームの概要とギャラリーの違いについて解説します：
・URLリンクを通して読んでください：https://powerplatformnikki.com/viewform/

##　Display　Formのコントロールの階層について解説：
・URLのリンクを通して読んでください：https://dx.si-jirei.jp/cloud-column-microsoft_powerplatform-5/

##　Display　Formに表示されているデータソースのフィールドを変更する方法：
・DetailScreen1ー＞DetailForm1に行きますとなぜだか与信評価といううデータカードが無いですね。
・それでは、それを追加します。
・DetailForm1をセレクトしたまま右側に現れるプロパティのフィールドにクリックします。
・フィールドの画面が表示された際には”フィールドの追加”に押します。
・オプションとしてフィールドの選択が現れましてそこに”与信評価”の選択をして”追加”ボタンを押します。
・そうしますと”与信評価”のフィールドが現れました。
・顧客管理表の一番下に表示されます。
・今度は同じ”フィールド”の画面を通して表示されているフィールドの順番を並び変えましょう。

##　Display Formのフィールドを修正する際の注意点：
登録日の修正をいたします。９時００分を取り除いて年・月・日のみを取り入れられるように修正します。
・まずは登録日のデータカードを選択します。
・今度は、右側に移っている詳細設定に”プロパティを変更するためのロックを解除します”にクリックして変更を可能とデータカードの変更を可能とします。

##　Display form上にあるコントロールのTextプロパティを修正する【Text関数の使い方】：
URLのリンクを通して：　https://ippu-biz.com/development/powerplatform/powerapps/text-date/
・DetailForm1ー＞登録日＿DataCard1ー＞DataCardValueへと行きます。
・プロパティに”Text”とセレクトします。
・それにまつわる数式に”Text(BrowserGallery1.Selected.登録日,DateTimeFormat.ShortDate)"と記載してください。
・そうすると、顧客管理表の登録日がちゃんと年・月・日と省略されます。

##　テキストラベルの表示を修正する【Selectedプロパティの応用】：
DetailScreen1のフォーム以外のコントロールを修正しようと思います。
・今回はDetailScreen1の顧客表テキストラベルの修正を行います。
・まずはDetailScreen1へと向かってそのラベルをセレクトします。
・次にLblAppName1をセレクトします。
・プロパティは”Text”です。
・そのプロパティの数式にこのように入れます”BrowseGallery1.Selected.顧客名”。

## EditScreenの概要とEdit formの役割について:
今回はEditScreenの編集と修正を行います。URL：https://learn.microsoft.com/en-us/power-apps/maker/model-driven-apps/create-and-edit-forms
・EditScreenをセレクトします。
・チェックマークの付いたコントローラをセレクトします。
・自動的にプロパティに見せられるのは”OnSelect”です。
・SubmitForm関数が記載された情報をデータソースへとセーブする役割を果たしています。 URL:https://learn.microsoft.com/en-us/power-platform/power-fx/reference/function-form

## Edit formにドロップダウンコントロールを配置する:
・まずはEditScreenのフィールドの並び替えを行います。
・EditFormをセレクトします。
・フィールドの配置の変え方は以前に行った副賞となります。
・ドロップダウンコントロールを配置します。
・EditFormの中にあるフィールドの与信調査＿DataCardの中にありますDataCardValueをセレクトします。
・挿入から入力のオプションにてドロップダウンを選択します。
・ロック解除と追加ボタンを押します。
・そのドロップダウンの中にテキストを埋め込みます。
・プロパティに”Items”をセレクトします。
・数式にこのように入れます”["未","済"]”。

## SubmitForm関数とUpdateプロパティについて:
先ほど配置したドロップダウンコントローラにSumitFormの数式を入れていきます。
・まずはEditFormの中にあるフィールドの与信調査＿DataCardの中にありますDataCardValueをセレクトします。
・プロパティに”Update”をセレクトします。
・その数式には元々あったDataCardValueが記載されています。
・その数式を変更します、Dropdown1.Selected.Value。
・元々あったテクスト入力のカードを削除します。
・エラー、罰点、マークが表示されます。
・罰点マークにクリックして数式の調整を施します。
・以前存在していたDataCardValueをDropdown1へと変更して、問題が解決されます。

## Edit formの2つの役割と3つのフォームモードについて:
EditFormでは編集と新規の導入があることを解説してきます。
・EditModeは編集モードと新規モードがあると認識してください。
・EditoForm1をセレクトします。
・プロパティに”DefaultMode”を選択します。
・数式にFromMode.Editっと書かれています。
・数式に”FromMode.New”と変えてみましょう。
・そうしますと記載されていた情報が消えて新しい情報が記載可能な状態になります。
・今度は”FromMode.View”へと数式をかえてください。
・そうしますと、今度は記載された情報たちがテキストレベルへと変換しました。読み取り専用のモードになります。

## If関数の基本的な使い方:
自分はもう知っている。

    If(条件式、値が真（しん）の場合、値が偽（にせ）の場合)

## Last関数を使ってEdit formが新規モードの際に顧客コードを自動採番する方法:
顧客コードの値を編集していきます。
・EditoForm１へと行きそして顧客コードをセレクトします。
・プロパティに”Update”を選択します。
・現在はDataCardValue11と数式枠に記載されています。
・まずは右側から詳細設定でプロパティの変更を許可をするようにロックを解除します。
・数式枠でこのようなIF関数を入れてください、If（EditForm１．Mode＝FromMode.New、Last（顧客管理表）.顧客コード＋１、DataCardValue１１．Text）。

## フォームモードによってコントロールのVisibleプロパティを変更する方法:
新規モードの時にもう一つ修正を施す必要のあるテクストがございますのでその修正をします。
・EditoForm１へと行きそして顧客コードをセレクトします。
・プロパティリストから”Visible”を選択してください。
・数式にはBooleanになっております。
・そこにIf関数を入れます、If（EditForm1.Mode＝FormMode.New,false,true）。
・そしたら試します”Play”ぼたんを押します。
・新規モードにしますと、以前存在した顧客コードが見えなくなっています。

## Edit formのディスプレイモードに応じてコントロールのディスプレイモードを条件分岐させる方法:
顧客コードが編集モードになっている場合に修正を施すことをします。
・EditoForm１ー＞顧客コードー＞DataCardValue3をセレクトします。
・プロパティに”DisplayMode”を選択します。
・その数式にIf関数を入れます、If（EditForm1.Mode＝FormMode.Edit,DisplayMode.View）。
・実際試してみます。”Play”ボタンを押して編集モードになりましたら、顧客コードが読み取りのみになっております。

## DataCard内にあるStarVisibleコントロールについて解説:
URL:https://powerusers.microsoft.com/t5/Building-Power-Apps/Card-for-a-required-field-does-not-display-the-The-StarVisible/td-p/125107

・EditForm１－＞顧客名＿Data＿DataCard2。
・右側に詳細設定にデータのRequireをFalseからTrueへを変更します。
・そうしますと新規モードのときに顧客名の記入が必須となります。

## 登録日の時間と分のコントロールを非表示にする:
直接削除をしますとエラーが発生します。その上、修正にも時間がかかります。なので時間と分の表示は非表示にします。
・EditFormにて時間と分の枠をセレクトしまして両方のプロパティの”Visible”をTrueからFalseへと変更します。
・今度は登録日のアップデータプロパティを変更する必要があります。
・その数式にこう入れます、Text（DateValue1.SelectedDate、DateTimeFormat。ShortDate）。

## キャンバスアプリの公開方法:
アプリの修正が完了しましたのでそのアプロの公開をしていきます。
・右上に公開といううボタンがありますのでそれを押していただきます。

## アプリを実際に起動して動作確認を行う:

## 日付フィールドに時間が入ってしまう不具合の回避方法:
・まずは顧客管理表の登録日の左側にもう一つフィールドを作ります。
・そのフィールドの名前を登録日と更新してください。
・そのあとEditFormにてそのフィールドを追加します。
・それでプロパティに”Update”を選択します。
・そしたら
・Previewをするときには顧客管理表のテーブルは閉じたままにしてください。
